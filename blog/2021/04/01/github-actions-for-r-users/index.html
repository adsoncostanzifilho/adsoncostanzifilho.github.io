<!DOCTYPE html>
<html lang="en-us">

  
<head>
  <link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
  <meta charset="utf-8">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <title>GitHub Actions for R Users</title>
  <meta name="author" content="Adson Costanzi Filho" />
  
  
  
  
  <meta name="keywords" content="devows, hugo, go, GitHub, GitHub-Actions">
  
  
  <meta name="description" content="Site template made by devcows using hugo">

  <meta name="generator" content="Hugo 0.78.2" />

  
  <link href='//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,500,700,800' rel='stylesheet' type='text/css'>

  
  <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.11.2/css/all.css">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  
  <link href="/css/animate.css" rel="stylesheet">

  
  
    <link href="/css/style.violet.css" rel="stylesheet" id="theme-stylesheet">
  

  
  <link href="/css/custom.css" rel="stylesheet">

  
  
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png" />

  
  <link href="/css/owl.carousel.css" rel="stylesheet">
  <link href="/css/owl.theme.css" rel="stylesheet">

  
  <link rel="alternate" href="https://adsoncostanzifilho.github.io/index.xml" type="application/rss+xml" title="Adson Costanzi Filho">

  
  
  
  
  
  
  
  <meta property="og:locale" content="en_us">
  <meta property="og:site_name" content="Adson Costanzi Filho">
  <meta property="og:title" content="GitHub Actions for R Users">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://adsoncostanzifilho.github.io/blog/2021/04/01/github-actions-for-r-users/" />
  <meta property="og:description" content="Site template made by devcows using hugo">
  <meta property="og:image" content="https://adsoncostanzifilho.github.io/img/banners/gha_tutorial.png">
  <meta property="og:image:type" content="image/png">
  
  
  
    <meta property="og:image:width" content="259">
    <meta property="og:image:height" content="300">
  
  
  <meta property="og:updated_time" content="2021-04-01T00:00:00Z">
  
    
    
    <meta property="article:section" content="Tutorial">
    <meta property="article:tag" content="GitHub">
    <meta property="article:tag" content="GitHub-Actions">
    
    
    <meta property="article:published_time" content="2021-04-01T00:00:00Z">
    <meta property="article:modified_time" content="2021-04-01T00:00:00Z">
  

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@GoHugoIO">
  <meta name="twitter:title" content="GitHub Actions for R Users">
  
  <meta name="twitter:image" content="https://adsoncostanzifilho.github.io/img/banners/gha_tutorial.png">
  
  <meta name="twitter:description" content="Site template made by devcows using hugo">
  

</head>


  <body>

    <div id="all">

        <header class="navbar-affixed-top" data-spy="affix" data-offset-top="62">
    <div class="navbar navbar-default yamm" role="navigation" id="navbar">    
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand home" href="https://adsoncostanzifilho.github.io/" id="logo">Adson Costanzi Filho
                   
                    <span class="sr-only">GitHub Actions for R Users - go to homepage</span>
                    
                </a>
                <div class="navbar-buttons">
                    <button type="button" class="navbar-toggle btn-template-main" data-toggle="collapse" data-target="#navigation">
                      <span class="sr-only">Toggle Navigation</span>
                        <i class="fas fa-align-justify"></i>
                    </button>
                </div>
            </div>
            

            <div class="navbar-collapse collapse" id="navigation">
                <ul class="nav navbar-nav navbar-right">
                  
                  
                  
                  <li class="dropdown">
                    
                    <a href="/">Home</a>
                    
                  </li>
                  
                  
                  <li class="dropdown">
                    
                    <a href="/about/">About</a>
                    
                  </li>
                  
                  
                  <li class="dropdown active">
                    
                    <a href="/blog/">Blog</a>
                    
                  </li>
                  
                </ul>
            </div>
            

            <div class="collapse clearfix" id="search">    
                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search">
                        <span class="input-group-btn">
                    <button type="submit" class="btn btn-template-main"><i class="fas fa-search"></i></button>
                </span>
                    </div>
                </form>
            </div>
            
        </div>
    </div>
</header>




        <div id="heading-breadcrumbs">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h1>GitHub Actions for R Users</h1>
            </div>
        </div>
    </div>
</div>


        <div id="content">
            <div class="container">

                <div class="row">

                    

                    <div class="col-md-9" id="blog-post">

                        
                          <p class="text-muted text-uppercase mb-small text-right">
                            By <a href="#">Adson Costanzi Filho</a>
                             | 
                            April 1, 2021
                          </p>
                        

                        <div id="post-content">
                          
<script src="https://adsoncostanzifilho.github.io/blog/2021/04/01/github-actions-for-r-users/index.en_files/header-attrs/header-attrs.js"></script>


<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>Recently I was introduced by some friends to the <strong>GitHub Actions</strong> and how it could help me execute tasks like: deploy my <em>Shiny Apps</em>, deploy this <em>Blogdown</em>, perform automated tests in packages, refresh data, and more. So, I decided to give it a try, and it was so simple and saved me so many work hours that I decided to write this post explaining how R developers can make good use of this amazing tool.</p>
<p>First the references I used to start on <em>GitHub Actions</em>:</p>
<ul>
<li><p>The Jim Hester presentation on the RStudio Conference <a href="https://www.jimhester.com/talk/2020-rsc-github-actions/">here</a>.</p></li>
<li><p>The GitHub Actions for the R language repository <a href="https://github.com/r-lib/actions">here</a>.</p></li>
<li><p>The GitHub Actions Documentation <a href="https://docs.github.com/en/actions/learn-github-actions">here</a>.</p></li>
</ul>
</div>
<div id="start-with-usethis" class="section level2">
<h2>Start with <code>usethis</code></h2>
<p>The easier and faster way to get started with the GitHub Actions in R is, for sure, using the <code>usethis</code> package! So, let’s first install it.</p>
<pre class="r"><code>install.packages(&quot;usethis&quot;)</code></pre>
<p>The first very interesting function about the GitHub Action in the <code>usethis</code> package is the <code>usethis::browse_github_actions()</code> with this function you can see the active actions running in the most diverse R packages. This is a very good start to give you an idea of what are the Actions used in big R packages like “shiny”, “dplyr”, etc.</p>
<p>The <code>usethis</code> also have the <code>usethis::use_github_action()</code> function, which in my opinion is the easier way to start. It will create for you the necessary files/folders structure necessary for GitHub understands and runs your <em>Actions</em>, in other words, it will create the <em>.github folder &gt; workflows folder &gt; .yaml file</em> inside your current project path. This function also needs as argument a specific workflow name (you can check the available options <a href="https://github.com/r-lib/actions/tree/master/examples">here</a>), depending on what option you choose it can give you a very good start point (sometimes you don’t need to change a thing). For example if you run <code>usethis::use_github_action("pkgdown")</code> it will create for you the default folder structure (<em>.github folder &gt; workflows folder &gt; file.yaml</em>) and it will start a <em>.yaml</em> file like this:</p>
<pre class="r"><code>on:
  push:
    branches:
      - main
      - master

name: pkgdown

jobs:
  pkgdown:
    runs-on: macOS-latest
    env:
      GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}
    steps:
      - uses: actions/checkout@v2

      - uses: r-lib/actions/setup-r@v1

      - uses: r-lib/actions/setup-pandoc@v1

      - name: Query dependencies
        run: |
          install.packages(&#39;remotes&#39;)
          saveRDS(remotes::dev_package_deps(dependencies = TRUE), &quot;.github/depends.Rds&quot;, version = 2)
          writeLines(sprintf(&quot;R-%i.%i&quot;, getRversion()$major, getRversion()$minor), &quot;.github/R-version&quot;)
        shell: Rscript {0}

      - name: Restore R package cache
        uses: actions/cache@v2
        with:
          path: ${{ env.R_LIBS_USER }}
          key: ${{ runner.os }}-${{ hashFiles(&#39;.github/R-version&#39;) }}-1-${{ hashFiles(&#39;.github/depends.Rds&#39;) }}
          restore-keys: ${{ runner.os }}-${{ hashFiles(&#39;.github/R-version&#39;) }}-1-

      - name: Install dependencies
        run: |
          remotes::install_deps(dependencies = TRUE)
          install.packages(&quot;pkgdown&quot;, type = &quot;binary&quot;)
        shell: Rscript {0}

      - name: Install package
        run: R CMD INSTALL .

      - name: Deploy package
        run: |
          git config --local user.email &quot;actions@github.com&quot;
          git config --local user.name &quot;GitHub Actions&quot;
          Rscript -e &#39;pkgdown::deploy_to_branch(new_process = FALSE)&#39;</code></pre>
<p>We will cover the presented steps inside the <em>.yaml</em> file later, as well as present some specific workflows for:</p>
<ul>
<li><p>Deploy your shiny on shinyapps.io automatically</p></li>
<li><p>Deploy your blogdow page on GitHub Pages automatically.</p></li>
<li><p>Perform automatic tests on your R packages.</p></li>
<li><p>Schedule some routines.</p></li>
</ul>
<blockquote>
<p>Remember, the GitHub will only execute the <em>.yaml</em> files inside the workflows folder (which is inside the <em>.github</em> folder)!</p>
</blockquote>
</div>
<div id="automatic-shiny-deploy" class="section level2">
<h2>Automatic Shiny Deploy</h2>
<p>How amazing would it be if every time you “push” a new feature in your shiny repository on GitHub it automatically performed the deployment procedures to bring the new version of your app online on <em>shinyapps.io</em>? Thanks to GitHub Actions it is now possible!</p>
<p>Before we start to make an Action procedure to deploy your shiny apps on <em>shinyapps.io</em> we must create the folder structure GitHub needs. So, let’s create the <em>.github</em> folder and inside it we should create the <em>workflows</em> folder and only then we can start our <em>.yaml</em> file.</p>
<p>Now that we have the structure we can start developing our deployment procedure. The first thing to do is to define which <strong>trigger</strong> we want to use to “activate” the GitHub Action. Let’s say we want GitHub to execute this every time we <strong>push</strong> on the <strong>master branch</strong>. So, our file should start like this:</p>
<pre class="r"><code># Triggered on push branch master
on:
  push:
    branches: [ master ]</code></pre>
<p>The second step is to define the <strong>name of the workflow</strong> and the <strong>operational system</strong> you want. GitHub actions has several OS options to choose including the 3 most popular ones ubuntu, macos and windows. I am going to name our procedure as “Shiny-Deploy” and we are going to use the macos-10.15.</p>
<blockquote>
<p>You can associate your actions to badges with the <code>usethis</code> package. For example, if the name of your workflow is “Shiny-Deploy” you can add this badge in your README file runing <code>usethis::use_github_actions_badge("Shiny-Deploy")</code>.</p>
</blockquote>
<pre class="r"><code># Name of the workflow - usethis::use_github_actions_badge(&quot;Shiny-Deploy&quot;)
name: Shiny-Deploy

# Set the job, the machine and the R version
jobs:
  Shiny-Deploy:
    runs-on: macos-10.15
    strategy:
      matrix:
        r-version: [4.0.2] </code></pre>
<p>Now that we already have our GitHub Actions machine we can start developing the steps! Let’s first clone the repository from the respective branch that has triggered the action.</p>
<p><em>PS</em>: from now on all the actions will be “inside” the <em>steps</em> structure.</p>
<pre class="r"><code>  steps:
        # Cloning your repository from the respective branch that has triggered it
      - uses: actions/checkout@v2</code></pre>
<p>Nice! We already made a copy of our files, now we need to set-up the R installation in our GitHub Actions machine to be able to run our R scripts. We will also set-up the <code>pandoc</code> to compile our shiny or Rmarkdown scripts.</p>
<pre class="r"><code>        # set-up an R installation in our GHA machine to run our scripts
      - name: Set up R ${{ matrix.r-version }}
        uses: r-lib/actions/setup-R@v1 # for macos
        with:
          r-version: ${{ matrix.r-version }}
        # We will also need pandoc to compile our Shiny or RMarkdown report
      - name: Setting up pandoc
        uses: r-lib/actions/setup-pandoc@v1</code></pre>
<p>From now on we can execute some R scripts directly in the shell of our GitHub Actions machine. Therefore, our next step will be to install all the packages your shiny app needs. Obviously, this step will change depending on what packages you used to build your app.</p>
<blockquote>
<p>Don’t forget to include the <code>rsconnect</code> package! We are going to use this package to connect our GitHub machine to the shinyapps server.</p>
</blockquote>
<pre class="r"><code>        # Install R packages
      - name: Install dependencies
        run: |
          install.packages(c(
            &quot;rsconnect&quot;,
            &quot;dplyr&quot;,
            &quot;shiny&quot;, 
            &quot;shinyjs&quot;,
            &quot;shinyWidgets&quot;,
            &quot;shinyalert&quot;,
            &quot;shinycssloaders&quot;,
            &quot;evaluate&quot;,
            &quot;highr&quot;,
            &quot;knitr&quot;,
            &quot;markdown&quot;,
            &quot;rmarkdown&quot;,
            &quot;stringi&quot;,
            &quot;stringr&quot;,
            &quot;tinytex&quot;,
            &quot;xfun&quot;
          ))
        shell: Rscript {0}</code></pre>
<p>Now comes the tricky part! In order to make the connection between your GitHub Actions machine and your shiny apps account we need to set your <strong>shiny apps token and key</strong>. Evidently, for security reasons you don’t want to publish you shinyapps credentials for everyone accessing your GitHub repository. However, we also need your token and keys to be able to deploy your app automatically, that is why we are going to use the <strong>GitHub Secrets</strong> feature!</p>
<p>First you need to go to your <a href="https://www.shinyapps.io/admin/">shiny apps account</a> click in your profile name and enter in the tokes option.</p>
<p><img src="/img/githubact_tutorial/shinyapps_token1.png" style="width:70.0%" /></p>
<p>If you don’t have created your shinyapps tokens yet, or if you want to use a new one, you can click on the <strong>+ Add Token</strong> button. Once you did that a new line will appear and you should be able to see your Token but not your Secret. You need to press the <strong>Show</strong> button followed by the <strong>Show Secret</strong> to be bale to copy your Secret credential.</p>
<p>Now we need to include this credentials on <strong>GitHub Secrets</strong>! To do that you need to enter in your GitHub repository page and go to <em>Settings</em>.</p>
<p><img src="/img/githubact_tutorial/settings.png" style="width:100.0%" /></p>
<p>On the left menu you should be able to see the <strong>Secrets</strong> option. Once you enter in the Secrets tab you will see the title “Actions secrets”, and just on its side you will see the “New repository secret” button. You need to click this button to create your encrypted environment variables (in this case your shinyapps credentials).</p>
<p><img src="/img/githubact_tutorial/secrets1.png" style="width:100.0%" /></p>
<p>We are going to create 2 different environment variables, the first named “SHINYAPP_TOKEN” and the second named “SHINYAPP_SECRET” (of course you can set any name you want). Once you clicked on the “New repository secret” button you will need to provide the name of your variable and the value of it and press “Add Secret”, as you can see below.</p>
<p><img src="/img/githubact_tutorial/shiny_token.png" style="width:100.0%" /></p>
<blockquote>
<p>Your Secret and Token don’t need to be in quotes (“my token”)!</p>
</blockquote>
<p>Ok, now we can use these two variables inside our <em>.yaml</em> file, and we should be able to deploy our app on the <em>shinyapps</em> server! You also must provide your <strong>shinyapps account name</strong>, <strong>your app name</strong>, and the <strong>directory of your app scripts</strong>. Sure you can set all this using the GitHub Secrets if you want.</p>
<pre class="r"><code>        # Connect on shinyapps server
      - name: Connect to ShinyApps
        env:
          # set the shinyapps keys as environment variables
          SHINY_TOKEN: ${{ secrets.SHINYAPP_TOKEN }}
          SHINY_SECRET: ${{ secrets.SHINYAPP_SECRET }}
        run: |
          shiny_token = Sys.getenv(&quot;SHINY_TOKEN&quot;)
          shiny_secret = Sys.getenv(&quot;SHINY_SECRET&quot;)
          rsconnect::setAccountInfo(name = &#39;adsoncostanzi&#39;, token = shiny_token, secret = shiny_secret)
        shell: Rscript {0}
        # deploy the app on shinyapps server
      - name: Deploy to shinyapps.io
        run: |
          rsconnect::deployApp(appName = &quot;soothsayeR&quot;, appDir = &quot;app&quot;)
        shell: Rscript {0}</code></pre>
<p>That’s it, now the GitHub will deploy your shiny on shinyapps any time you “push” on the master branch!</p>
<p>For reasons of copy and paste, here is the full <em>.yaml</em> file!</p>
<blockquote>
<p>Follow the indentation, it is an essential part of the code!</p>
</blockquote>
<pre class="r"><code># Triggered on push branch master
on:
  push:
    branches: [ master ]

# Name of the workflow - usethis::use_github_actions_badge(&quot;Shiny-Deploy&quot;)
name: Shiny-Deploy

# Set the job, the machine and the R version
jobs:
  Shiny-Deploy:
    #runs-on: ubuntu-latest 
    runs-on: macos-10.15
    strategy:
      matrix:
        r-version: [4.0.2] 
        
    steps:
        # Cloning your repository from the respective branch that has triggered it
      - uses: actions/checkout@v2
        # set-up an R installation in our GHA machine to run our scripts
      - name: Set up R ${{ matrix.r-version }}
        uses: r-lib/actions/setup-R@v1 # for macos
        with:
          r-version: ${{ matrix.r-version }}
        # We will also need pandoc to compile our Shiny or RMarkdown report
      - name: Setting up pandoc
        uses: r-lib/actions/setup-pandoc@v1
        # Install R packages
      - name: Install dependencies
        run: |
          install.packages(c(
            &quot;rsconnect&quot;,
            &quot;dplyr&quot;,
            &quot;shiny&quot;, 
            &quot;shinyjs&quot;,
            &quot;shinyWidgets&quot;,
            &quot;shinyalert&quot;,
            &quot;shinycssloaders&quot;,
            &quot;evaluate&quot;,
            &quot;highr&quot;,
            &quot;knitr&quot;,
            &quot;markdown&quot;,
            &quot;rmarkdown&quot;,
            &quot;stringi&quot;,
            &quot;stringr&quot;,
            &quot;tinytex&quot;,
            &quot;xfun&quot;
          ))
        shell: Rscript {0}
        # Connect in shinyapps server
      - name: Connect to ShinyApps
        env:
          # set the shinyapps keys as environment variables
          SHINY_TOKEN: ${{ secrets.SHINYAPP_TOKEN }}
          SHINY_SECRET: ${{ secrets.SHINYAPP_SECRET }}
        run: |
          shiny_token = Sys.getenv(&quot;SHINY_TOKEN&quot;)
          shiny_secret = Sys.getenv(&quot;SHINY_SECRET&quot;)
          rsconnect::setAccountInfo(name = &#39;adsoncostanzi&#39;, token = shiny_token, secret = shiny_secret)
        shell: Rscript {0}
        # deploy the app on shinyapps server
      - name: Deploy to shinyapps.io
        run: |
          rsconnect::deployApp(appName = &quot;soothsayeR&quot;, appDir = &quot;app&quot;)
        shell: Rscript {0}</code></pre>
</div>
<div id="automatic-blogdown-deploy" class="section level2">
<h2>Automatic Blogdown Deploy</h2>
<p>What about make your blogdown deploy automatic on GitHub Pages? Every time you write a new post you will only need to “push” and the GitHub Actions will take care of the rest! This procedure works very similar to the shiny one, so let’s start our <em>.yaml</em> file!</p>
<p>For the blogdwon deploy purpose we are going to use two different branches: The first one named <strong>“source”</strong> that will contain the <strong>development side</strong> of our blogdown. And the <strong>“master”</strong> branch that will expose the <strong>built page</strong> (the master branch will receive the result of <code>blogdown::build_site(local = FALSE)</code>).</p>
<blockquote>
<p>The master branch MUST be the one with the <code>build_site()</code> content!</p>
</blockquote>
<p>This way we will set our trigger as a “push” on the “source” branch:</p>
<pre class="r"><code># Triggered on push branch source
on:
  push:
     branches:
       - source</code></pre>
<p>In the next step, we will define the workflow name and the OS we want to use. For this example, we are going to name our workflow as “deployblog” and the OS will be an Ubuntu 18.04.</p>
<pre class="r"><code># Name of the workflow - usethis::use_github_actions_badge(&quot;deployblog&quot;)
name: deployblog

# Set the job, the machine
jobs:
  deployblog:
    name: Render and deploy blogdown
    runs-on: ubuntu-18.04</code></pre>
<p>The easier part is done, now let’s start the steps! So, we are going to clone the repository (on the “source” branch), and set up R and pandoc, as we did on the shiny deploy session.</p>
<p><em>PS</em>: from now on all the actions will be “inside” the <em>steps</em> structure.</p>
<pre class="r"><code>    steps:
      # Cloning your repository from the respective branch that has triggered it
      - uses: actions/checkout@v2
        with:
          submodules: true
          fetch-depth: 0
        # set-up an R installation in our GHA machine to run our scripts
      - uses: r-lib/actions/setup-r@v1
        # We will also need pandoc to compile our Shiny or RMarkdown report
      - uses: r-lib/actions/setup-pandoc@v1</code></pre>
<p>Now that we have our scripts and the R settled up we can proceed with the package installation, as well as <strong>install HUGO</strong>, as follows:</p>
<pre class="r"><code>     # Install R packages
      - name: Install r packages
        run: |
          Rscript -e &#39;install.packages(c(&quot;remotes&quot;, &quot;rmarkdown&quot;))&#39; \
                  -e &#39;remotes::install_github(&quot;rstudio/blogdown&quot;)&#39;
      - name: install hugo
        # Install Hugo
        run: Rscript -e &#39;blogdown::install_hugo(extended = TRUE, version = &quot;0.78.2&quot;)&#39;
      - name: Get themes
        run: git submodule update --remote</code></pre>
<p>That finished we must be able to render/build our blogdown in a specific folder (in this case will be the “public” folder) using the <code>blogdown::build_site(local = FALSE)</code> function. That done we just need to push the content of the “public” folder to the master branch and your blogdown will be online on GitHub Pages!</p>
<pre class="r"><code>      - name: Look at files
        run: ls ./public
      - name: Render blog
        run: Rscript -e &#39;blogdown::build_site(local = FALSE)&#39;
      - name: Deploy
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_branch: master</code></pre>
<blockquote>
<p>I <strong>STOLE</strong> THIS SCRIPT FROM MY GOOD FRIEND <a href="https://github.com/lcgodoy">LUCAS GODOY</a> (he also taught me how to make it work)!</p>
</blockquote>
<p>For reasons of copy and paste, here is the full <em>.yaml</em> file!</p>
<pre class="r"><code># Triggered on push branch source
on:
  push:
     branches:
       - source

# Name of the workflow - usethis::use_github_actions_badge(&quot;deployblog&quot;)
name: deployblog

# Set the job, the machine
jobs:
  deployblog:
    name: Render and deploy blogdown
    runs-on: ubuntu-18.04
    steps:
      # Cloning your repository from the respective branch that has triggered it
      - uses: actions/checkout@v2
        with:
          submodules: true
          fetch-depth: 0
        # set-up an R installation in our GHA machine to run our scripts
      - uses: r-lib/actions/setup-r@v1
        # We will also need pandoc to compile our Shiny or RMarkdown report
      - uses: r-lib/actions/setup-pandoc@v1
        # Install R packages
      - name: Install r packages
        run: |
          Rscript -e &#39;install.packages(c(&quot;remotes&quot;, &quot;rmarkdown&quot;))&#39; \
                  -e &#39;remotes::install_github(&quot;rstudio/blogdown&quot;)&#39;
      - name: install hugo
        # Install Hugo
        run: Rscript -e &#39;blogdown::install_hugo(extended = TRUE, version = &quot;0.78.2&quot;)&#39;
      - name: Get themes
        run: git submodule update --remote
      - name: Look at files
        run: ls ./public
      - name: Render blog
        run: Rscript -e &#39;blogdown::build_site(local = FALSE)&#39;
      - name: Deploy
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_branch: master
          publish_dir: ./public</code></pre>
</div>
<div id="automatic-tests" class="section level2">
<h2>Automatic Tests</h2>
<p>I would say that execute tests manually can be the most time-consuming job presented in this post, and that is why performing automatic tests can save you lots of work hours! I know that automatic tests are very specific, in other words, it will depend on what kind of tests you want to perform. However, we can have a very good start point with the <code>usethis</code> package!</p>
<p>For example, by running the <code>usethis::use_github_action_check_full()</code> function it will create the default R-CMD-check procedure for you in a GitHub Actions structure. The R-CMD-check will stimulate the usage of your codes on the most diverse environments, such as on windows, ubuntu and, macos, all the three running different R versions as well. My advise is use as a start point the <em>.yaml</em> provided by the <code>usethis::use_github_action_check_full()</code> function to perform your own automatic tests.</p>
<p>You can find below the <em>.yaml</em> file generated by the <code>usethis::use_github_action_check_full()</code> function:</p>
<pre class="r"><code>on:
  push:
    branches:
      - main
      - master
  pull_request:
    branches:
      - main
      - master

name: R-CMD-check

jobs:
  R-CMD-check:
    runs-on: ${{ matrix.config.os }}

    name: ${{ matrix.config.os }} (${{ matrix.config.r }})

    strategy:
      fail-fast: false
      matrix:
        config:
          - {os: macOS-latest,   r: &#39;release&#39;}
          - {os: windows-latest, r: &#39;release&#39;}
          - {os: windows-latest, r: &#39;3.6&#39;}
          - {os: ubuntu-18.04,   r: &#39;devel&#39;, rspm: &quot;https://packagemanager.rstudio.com/cran/__linux__/bionic/latest&quot;, http-user-agent: &quot;R/4.0.0 (ubuntu-18.04) R (4.0.0 x86_64-pc-linux-gnu x86_64 linux-gnu) on GitHub Actions&quot; }
          - {os: ubuntu-18.04,   r: &#39;release&#39;, rspm: &quot;https://packagemanager.rstudio.com/cran/__linux__/bionic/latest&quot;}
          - {os: ubuntu-18.04,   r: &#39;oldrel&#39;,  rspm: &quot;https://packagemanager.rstudio.com/cran/__linux__/bionic/latest&quot;}
          - {os: ubuntu-18.04,   r: &#39;3.5&#39;,     rspm: &quot;https://packagemanager.rstudio.com/cran/__linux__/bionic/latest&quot;}
          - {os: ubuntu-18.04,   r: &#39;3.4&#39;,     rspm: &quot;https://packagemanager.rstudio.com/cran/__linux__/bionic/latest&quot;}
          - {os: ubuntu-18.04,   r: &#39;3.3&#39;,     rspm: &quot;https://packagemanager.rstudio.com/cran/__linux__/bionic/latest&quot;}

    env:
      RSPM: ${{ matrix.config.rspm }}
      GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}

    steps:
      - uses: actions/checkout@v2

      - uses: r-lib/actions/setup-r@v1
        id: install-r
        with:
          r-version: ${{ matrix.config.r }}
          http-user-agent: ${{ matrix.config.http-user-agent }}

      - uses: r-lib/actions/setup-pandoc@v1

      - name: Install pak and query dependencies
        run: |
          install.packages(&quot;pak&quot;, repos = &quot;https://r-lib.github.io/p/pak/dev/&quot;)
          saveRDS(pak::pkg_deps(&quot;local::.&quot;, dependencies = TRUE), &quot;.github/r-depends.rds&quot;)
        shell: Rscript {0}

      - name: Restore R package cache
        uses: actions/cache@v2
        with:
          path: |
            ${{ env.R_LIBS_USER }}
            !${{ env.R_LIBS_USER }}/pak
          key: ${{ matrix.config.os }}-${{ steps.install-r.outputs.installed-r-version }}-1-${{ hashFiles(&#39;.github/r-depends.rds&#39;) }}
          restore-keys: ${{ matrix.config.os }}-${{ steps.install-r.outputs.installed-r-version }}-1-

      - name: Install system dependencies
        if: runner.os == &#39;Linux&#39;
        run: |
          pak::local_system_requirements(execute = TRUE)
          pak::pkg_system_requirements(&quot;rcmdcheck&quot;, execute = TRUE)
        shell: Rscript {0}

      - name: Install dependencies
        run: |
          pak::local_install_dev_deps(upgrade = TRUE)
          pak::pkg_install(&quot;rcmdcheck&quot;)
        shell: Rscript {0}

      - name: Session info
        run: |
          options(width = 100)
          pkgs &lt;- installed.packages()[, &quot;Package&quot;]
          sessioninfo::session_info(pkgs, include_base = TRUE)
        shell: Rscript {0}

      - name: Check
        env:
          _R_CHECK_CRAN_INCOMING_: false
        run: |
          options(crayon.enabled = TRUE)
          rcmdcheck::rcmdcheck(args = c(&quot;--no-manual&quot;, &quot;--as-cran&quot;), error_on = &quot;warning&quot;, check_dir = &quot;check&quot;)
        shell: Rscript {0}

      - name: Show testthat output
        if: always()
        run: find check -name &#39;testthat.Rout*&#39; -exec cat &#39;{}&#39; \; || true
        shell: bash

      - name: Upload check results
        if: failure()
        uses: actions/upload-artifact@main
        with:
          name: ${{ matrix.config.os }}-r${{ matrix.config.r }}-results
          path: check</code></pre>
</div>
<div id="scheduled-routines" class="section level2">
<h2>Scheduled Routines</h2>
<p>GitHub Actions also provides the option of schedule routines, in other words, <strong>you can define as triggers any specific time you want</strong>. To do that GitHub Actions uses the <a href="https://pubs.opengroup.org/onlinepubs/9699919799/utilities/crontab.html#tag_20_25_07">cron syntax</a>, that is the hard part (at least for me who had never used it). First, let’s understand the syntax GitHub Actions uses to run the scheduled routines!</p>
<p>The <em>cron syntax</em> is divided in <strong>5 pieces</strong> (*****):</p>
<ul>
<li><p>The first peace is to define the minute <strong>(0 - 59)</strong></p></li>
<li><p>The second peace is to define the hour <strong>(0 - 23)</strong></p></li>
<li><p>The third peace is to define the day of the month <strong>(1 - 31)</strong></p></li>
<li><p>The fourth peace is to define month <strong>(1 - 12)</strong></p></li>
<li><p>The fifth peace is to define the day of the week <strong>(0 - 6)</strong></p></li>
</ul>
<p>Obviously, you don’t want to run your routine just once! So, you need some way to abstract some of the pieces, in the con syntax, it is by using an <strong>asterisk</strong> (*). For example, the <code>*****</code> means run the routine every minute every day!</p>
<blockquote>
<p>Kip in mind that the GitHub times are based on <strong>UTC</strong>!</p>
</blockquote>
<p>Here there are some helpful examples I took from <a href="https://jasonet.co/posts/scheduled-actions/">this post</a>:</p>
<pre class="r"><code># Every Monday at 1PM UTC (9AM EST)
0 13 * * 1

# At the end of every day
0 0 * * *

# Every 10 minutes
*/10 * * * *</code></pre>
<p>What about the <em>.yaml</em> syntax? It is very simple, instead of using the “on” followed by “push”, “merge”, “pull_request”, etc., you should write “schedule” and it is done!</p>
<pre class="r"><code>on:
  schedule:
    - cron: &#39;0 0 * * *&#39;</code></pre>
</div>
<div id="that-is-all" class="section level2">
<h2>That is all</h2>
<p>I hope someone finds this tutorial useful. As always your feedback is much appreciated, feel free to get in touch with me over social media! 😄</p>
</div>

                        </div>
                        
                        

                    </div>
                    

                    

                    

                    <div class="col-md-3">

                        

                        

<div class="panel panel-default sidebar-menu">

    <div class="panel-heading">
      <h3 class="panel-title">Search</h3>
    </div>

    <div class="panel-body">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" role="search">
            <div class="input-group">
                <input type="search" name="q" class="form-control" placeholder="Search">
                <input type="hidden" name="sitesearch" value="https://adsoncostanzifilho.github.io/">
                <span class="input-group-btn">
                    <button type="submit" class="btn btn-template-main"><i class="fas fa-search"></i></button>
                </span>
            </div>
        </form>
    </div>
</div>







<div class="panel panel-default sidebar-menu">

    <div class="panel-heading">
        <h3 class="panel-title">Categories</h3>
    </div>

    <div class="panel-body">
        <ul class="nav nav-pills nav-stacked">
            
            
            <li>
                <a href="/categories/project">project (3)</a>
            </li>
            
            <li>
                <a href="/categories/r">r (6)</a>
            </li>
            
            <li>
                <a href="/categories/shiny">shiny (2)</a>
            </li>
            
            <li>
                <a href="/categories/tutorial">tutorial (3)</a>
            </li>
            
        </ul>
    </div>

</div>








<div class="panel sidebar-menu">

    <div class="panel-heading">
        <h3 class="panel-title">Tags</h3>
    </div>

    <div class="panel-body">
        <ul class="tag-cloud">
            
            
            <li>
                <a href="/tags/blogdown"><i class="fas fa-tags"></i> blogdown</a>
            </li>
            
            <li>
                <a href="/tags/csgo"><i class="fas fa-tags"></i> csgo</a>
            </li>
            
            <li>
                <a href="/tags/devtools"><i class="fas fa-tags"></i> devtools</a>
            </li>
            
            <li>
                <a href="/tags/github"><i class="fas fa-tags"></i> github</a>
            </li>
            
            <li>
                <a href="/tags/github-actions"><i class="fas fa-tags"></i> github-actions</a>
            </li>
            
            <li>
                <a href="/tags/httr"><i class="fas fa-tags"></i> httr</a>
            </li>
            
            <li>
                <a href="/tags/jsonlite"><i class="fas fa-tags"></i> jsonlite</a>
            </li>
            
            <li>
                <a href="/tags/pkgdown"><i class="fas fa-tags"></i> pkgdown</a>
            </li>
            
            <li>
                <a href="/tags/rmarkdown"><i class="fas fa-tags"></i> rmarkdown</a>
            </li>
            
            <li>
                <a href="/tags/roxygen2"><i class="fas fa-tags"></i> roxygen2</a>
            </li>
            
            <li>
                <a href="/tags/rtweet"><i class="fas fa-tags"></i> rtweet</a>
            </li>
            
            <li>
                <a href="/tags/shiny"><i class="fas fa-tags"></i> shiny</a>
            </li>
            
            <li>
                <a href="/tags/shinyjs"><i class="fas fa-tags"></i> shinyjs</a>
            </li>
            
            <li>
                <a href="/tags/tidytext"><i class="fas fa-tags"></i> tidytext</a>
            </li>
            
            <li>
                <a href="/tags/usethis"><i class="fas fa-tags"></i> usethis</a>
            </li>
            
        </ul>
    </div>

</div>






                        

                    </div>
                    

                    

                </div>
                

            </div>
            
        </div>
        

        <footer id="footer">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js">
  </script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js">
  </script>

  <script>
  hljs.initHighlightingOnLoad();
  </script>
  
  
   <div class="my_footer">
     <b class="contact"></b>
     <b> </b>
     <a href="https://www.linkedin.com/in/adsoncostanzifilho/">
      <i class="fab fa-linkedin my_social"></i>
     </a>
     <a href="https://github.com/adsoncostanzifilho/">
      <i class="fab fa-github-square my_social"></i>
     </a>
     <a href="https://twitter.com/AdsonCostanzi">
      <i class="fab fa-twitter-square my_social"></i>
     </a>
     <a href="mailto:adsoncostanzi32@gmail.com">
      <i class="fa fa-envelope-square my_social"></i>
     </a>
     <a href="https://www.buymeacoffee.com/adsoncostanzi" target="_blank"><img src="/img/bmc2.png" height="28" width="28" class ="bmc">
     </a>

     <hr>
   </div>
   
</footer>







<div id="copyright">
    <div class="container">
        <div class="col-md-12">
            <p class="pull-right">
              Template by <a href="https://bootstrapious.com/p/universal-business-e-commerce-template">Bootstrapious</a>.
              

              Ported to Hugo by <a href="https://github.com/devcows/hugo-universal-theme">DevCows</a>.
            </p>
        </div>
    </div>
</div>





    </div>
    

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-158917104-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

<script src="//code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/Counter-Up/1.0/jquery.counterup.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-parallax/1.1.3/jquery-parallax.js"></script>

<script src="/js/front.js"></script>


<script src="/js/owl.carousel.min.js"></script>



  </body>
</html>
